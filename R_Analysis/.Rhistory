library(spatstat)
install.packages(c("spatstat", "rgdal", "maptools"))
library(spatstat)
library(rgdal)
library(maptools)
detach("package:maptools", unload=TRUE)
library(maptools)
setwd("~/Dropbox/Code/CentralPlaceWiki/R_Analysis")
declared  <- readOGR(".","Declared_proj")
extracted <- readOGR(".","Extracted_proj")
declared  <- readOGR("Shapefiles","Declared_proj")
extracted <- readOGR("Shapefiles","Extracted_proj")
germany <- readOGR("Shapefiles", "de-states")
germany.window <- as.owin(germany)
class(germany.window)
declared.ppp  <- as.ppp(coordinates(declared),  germany.window)
extracted.ppp <- as.ppp(coordinates(extracted), germany.window)
nn <- nncross(declared.ppp,extracted.ppp)
neighbors = nn$which
distances = nn$dist
plot(superimpose(declared.ppp=declared.ppp,extracted.ppp=extracted.ppp), main="nncross", cols=c("red","blue"))
boxplot (distances/1000)
plot(superimpose(declared.ppp=declared.ppp,extracted.ppp=extracted.ppp), main="nncross", cols=c("red","blue"))
arrows(declared.ppp$x, declared.ppp$y, extracted.ppp[N]$x, extracted.ppp[N]$y, length=0.15)
arrows(declared.ppp$x, declared.ppp$y, extracted.ppp[neighbors]$x, extracted.ppp[neighbors]$y, length=0.15)
summary(distances/1000)
table(distances)
k_ex <- Kest(extracted.ppp)
k_ex
k_dec <- Kest(declared.ppp)
plot(k_ex)
plot(k_dec)
plot(k_ex)
nn <- nncross(declared.ppp,extracted.ppp)
neighbors = nn$which # indicies of nearest neighbors
distances = nn$dist  # distances
plot(superimpose(declared.ppp=declared.ppp,extracted.ppp=extracted.ppp), main="nncross", cols=c("red","blue"))
arrows(declared.ppp$x, declared.ppp$y, extracted.ppp[neighbors]$x, extracted.ppp[neighbors]$y, length=0.15)
