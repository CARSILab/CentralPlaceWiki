# PLACES LINKING TO New York City

SELECT row_number() OVER() As fake_id, t_en, the_geom, "from" 
FROM wp_coords_red0, links
WHERE "to" like 'New York City'
AND  "from" =  t_en

SELECT links."from", links."to", wp_coords_red0.titel,wp_coords_red0.the_geom , wp_coords_red0.primarykey
FROM links, wp_coords_red0
WHERE links."to" = 'Brooklyn'
AND links."from" = wp_coords_red0.titel


# convex hull example

SELECT row_number() OVER() As fake_id, lang, ST_ConvexHull(ST_Collect(the_geom::geometry)) As hull_geom
    FROM pagesgeom as p, links as l
	WHERE page like 'New%'
    GROUP BY lang;


# convex hull around places linking to NYC:

SELECT row_number() OVER() As fake_id, p.lang, ST_ConvexHull(ST_Collect(p.the_geom::geometry)) As hull_geom
    FROM pagesgeom as p, links as l
	WHERE l."to" = 'New York City'
	AND l."from" = p.page
	AND l.lang = p.lang
    GROUP BY p.lang;
